**
FUNCTION numletra
PARAMETER NUMEROQ, DODOLARES
IF TYPE("dodolares")<>"N"
DODOLARES = 0
ENDIF
PRIVATE NUML, ENTE, DECIM, ENTLET, DECIMLET, RESUL
NUML = ALLTRIM(STR(NUMEROQ, 18, 2))
NUML = REPLICATE('0', 18-LEN(NUML))+NUML
ENTE = LEFT(NUML, 15)
DECIM = RIGHT(NUML, 2)
IF ENTE>'000000000000000'
ENTLET = LETER(VAL(ENTE))
IF DECIM='00'
IF VAL(ENTE)>1
IF DODOLARES=1
DECIMLET = 'dolares con 00/100'
ELSE
IF DODOLARES=2
DECIMLET = 'quetzales Con 00/100'
ELSE
DECIMLET = 'Con 00/100'
ENDIF
ENDIF
ELSE
IF DODOLARES=1
DECIMLET = 'dolar Con 00/100'
ELSE
IF DODOLARES=2
DECIMLET = 'Quetzal Con 00/100'
ELSE
DECIMLET = 'Con 00/100'
ENDIF
ENDIF
ENDIF
ELSE
IF DODOLARES=1
IF VAL(ENTE)>1
DECIMLET="dolares con &decim/100"
ELSE
DECIMLET="dolar con &decim/100"
ENDIF
ELSE
IF DODOLARES=2
IF VAL(ENTE)>1
DECIMLET="quetzales con &decim/100"
ELSE
DECIMLET="quetzal con &decim/100"
ENDIF
ELSE
DECIMLET="con &decim/100"
ENDIF
ENDIF
ENDIF
RESUL = ENTLET+DECIMLET
ELSE
ENTLET = ''
IF DECIM='01'
DECIMLET = "un centavo"
ELSE
DECIMLET = LETER(VAL(DECIM))
DECIMLET = DECIMLET+"centavos"
ENDIF
RESUL = DECIMLET
ENDIF
RETURN RESUL
ENDFUNC
**
FUNCTION leter
PARAMETER NUMERO
DIMENSION GRUPOS[5]
PRIVATE GRUPOS[5], ENLETRA, GRUPO, NUMSTR, UNIDADX_, DECENA, CENTENA, UNI0, UNI1, UNI2, UNI3, UNI4, UNI5, UNI6, UNI7, UNI8, UNI9, DEC0, DEC1, DEC2, DEC3, DEC4, DEC5, DEC6, DEC7, DEC8, DEC9, CEN0, CEN1, CEN2, CEN3, CEN4, CEN5, CEN6, CEN7, CEN8, CEN9, DEC11, DEC12, DEC13, DEC14, DEC15, DEC16, DEC17, DEC18, DEC19, CONECT1, CONECT2, CONECT3, CONECT4, CONECT5, UNILET, DECLET, CENLET, CONECTOR, GRUPOSTR
ENLETRA = ''
NUMSTR = ALLTRIM(STR(NUMERO))
NUMSTR = REPLICATE('0', 15-LEN(NUMSTR))+NUMSTR
FOR GRUPO = 1 TO 5
GRUPOS[5-GRUPO+1] = SUBSTR(NUMSTR, (GRUPO-1)*3+1, 3)
ENDFOR
DEC10 = ''
DEC11 = 'once '
DEC12 = 'doce '
DEC13 = 'trece '
DEC14 = 'catorce '
DEC15 = 'quince '
DEC16 = 'dieciseis '
DEC17 = 'diecisiete '
DEC18 = 'dieciocho '
DEC19 = 'diecinueve '
CONECT1 = ''
IF GRUPOS(2)>'000'
CONECT2 = 'mil '
ELSE
CONECT2 = ''
ENDIF
IF GRUPOS(3)>'000' .OR. GRUPOS(4)>'000'
IF GRUPOS(3)='001'
CONECT3 = 'millon '
ELSE
CONECT3 = 'millones '
ENDIF
ELSE
CONECT3 = ''
ENDIF
IF GRUPOS(4)>'000'
CONECT4 = 'mil '
ELSE
CONECT4 = ''
ENDIF
IF GRUPOS(5)>'000'
IF GRUPOS(5)='001'
CONECT5 = 'billon '
ELSE
CONECT5 = 'billones '
ENDIF
ELSE
CONECT5 = ''
ENDIF
DEC0 = ''
CEN0 = ""
CEN2 = 'doscientos '
CEN3 = 'trescientos '
CEN4 = 'cuatrocientos '
CEN5 = 'quinientos '
CEN6 = 'seiscientos '
CEN7 = 'setecientos '
CEN8 = 'ochocientos '
CEN9 = 'novecientos '
FOR GRUPO = 5 TO 1 STEP -1
UNIDADX_ = RIGHT(GRUPOS(GRUPO), 1)
DECENA = SUBSTR(GRUPOS(GRUPO), 2, 1)
CENTENA = LEFT(GRUPOS(GRUPO), 1)
IF NUMERO=0 .AND. GRUPO=1
UNI0 = 'cero '
ELSE
UNI0 = ''
ENDIF
IF DECENA='1' .AND. UNIDADX_='0'
DEC1 = 'diez '
ELSE
DEC1 = ''
ENDIF
IF UNIDADX_='0'
DEC2 = 'veinte '
ELSE
DEC2 = 'veinti'
ENDIF
IF UNIDADX_<>'0'
DEC3 = 'treinta y '
ELSE
DEC3 = 'treinta '
ENDIF
IF UNIDADX_<>'0'
DEC4 = 'cuarenta y '
ELSE
DEC4 = 'cuarenta '
ENDIF
IF UNIDADX_<>'0'
DEC5 = 'cincuenta y '
ELSE
DEC5 = 'cincuenta '
ENDIF
IF UNIDADX_<>'0'
DEC6 = 'sesenta y '
ELSE
DEC6 = 'sesenta '
ENDIF
IF UNIDADX_<>'0'
DEC7 = 'setenta y '
ELSE
DEC7 = 'setenta '
ENDIF
IF UNIDADX_<>'0'
DEC8 = 'ochenta y '
ELSE
DEC8 = 'ochenta '
ENDIF
IF UNIDADX_<>'0'
DEC9 = 'noventa y '
ELSE
DEC9 = 'noventa '
ENDIF
IF DECENA='1'
UNI1=DEC1&UNIDADX_
ELSE
IF GRUPOS(GRUPO)='001' .AND. (GRUPO=2 .OR. GRUPO=4)
UNI1 = ''
ELSE
IF GRUPO>2
UNI1 = 'un '
ELSE
UNI1 = 'uno '
ENDIF
ENDIF
ENDIF
IF DECENA='1'
UNI2=DEC1&UNIDADX_
ELSE
UNI2 = 'dos '
ENDIF
IF DECENA='1'
UNI3=DEC1&UNIDADX_
ELSE
UNI3 = 'tres '
ENDIF
IF DECENA='1'
UNI4=DEC1&UNIDADX_
ELSE
UNI4 = 'cuatro '
ENDIF
IF DECENA='1'
UNI5=DEC1&UNIDADX_
ELSE
UNI5 = 'cinco '
ENDIF
IF DECENA='1'
UNI6=DEC1&UNIDADX_
ELSE
UNI6 = 'seis '
ENDIF
IF DECENA='1'
UNI7=DEC1&UNIDADX_
ELSE
UNI7 = 'siete '
ENDIF
IF DECENA='1'
UNI8=DEC1&UNIDADX_
ELSE
UNI8 = 'ocho '
ENDIF
IF DECENA='1'
UNI9=DEC1&UNIDADX_
ELSE
UNI9 = 'nueve '
ENDIF
IF DECENA+UNIDADX_='00'
CEN1 = 'cien '
ELSE
CEN1 = 'ciento '
ENDIF
UNILET=UNI&UNIDADX_
DECLET=DEC&DECENA
CENLET=CEN&CENTENA
GRUPOSTR = STR(GRUPO, 1)
CONECTOR=CONECT&GRUPOSTR
ENLETRA = ENLETRA+CENLET+DECLET+UNILET+CONECTOR
ENDFOR
RETURN ENLETRA
ENDFUNC
**
FUNCTION cualnu
DO CASE
CASE M.EFECTIVO<>0
RETURN 1
CASE M.CHEQUE<>0
RETURN 2
CASE M.MONTOD<>0
RETURN 3
CASE M.DEPOSITO<>0
ENDCASE
RETURN 1
ENDFUNC
**
