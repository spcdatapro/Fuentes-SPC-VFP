SELECT IIF(ENVIADO,'** '+ALLTRIM(A.DESCRIPCION),a.DESCRIPCION) as DESCRIPCION, ;
ALLTRIM(STR(B.CANTIDAD-B.FACTURADO,10,2)) AS PAGADO,;
b.subtotal,;
B.COURSE , ;
ALLTRIM(STR(SILLA)) AS SILLAL, ;
b.producto , ;
B.DETALLE_COMANDA, ;
b.ENVIADO,;
B.SILLA,;
B.COMANDA,;
0 AS POWER,;
B.PARTICION, ;
0 AS ESPOWER,;
b.ESEXTRA, ;
B.CANTIDAD, ;
B.NOTAS, ;
G.SUBGRUPO,;
G.UBICACION_PRINT,;
H.PRODUCTO AS REF,;
D.DIRECCION AS UBICACION, ;
I.IDENTIFICADOR AS MESA, ;
SPACE(100) AS MESERO, ;
g.TIPO, ;
e.garrotero, ;
d.replicaren, ;
I.SALON AS SALON, ;
G.PORSALON, ;
E.MESERO AS IDMESERO, ;
b.IDPOWER, ;
E.IDTOGO ;
FROM DETALLE_PRODUCTO a, detalle_comanda b,UBICACION_PRINT D, COMANDA E, SUBGRUPO G,PRODUCTO_MENU H, DETALLE_SALON I ;
where b.comanda = 229 AND e.comanda=b.comanda AND H.PRODUCTO=A.PRODUCTO AND ;
b.PRODUCTO=a.DETALLE_PRODUCTO AND H.SUBGRUPO=G.SUBGRUPO  AND IIF(B.course=0 OR B.course=g.course,G.UBICACION_PRINT=D.UBICACION_PRINT,B.course=d.course);
AND E.MESA=I.MESA AND b.DETALLE AND EMPTY(b.POWER) AND EMPTY(b.ESEXTRA) AND !B.ENVIADO;
ORDER BY DETALLE_COMANDA desc